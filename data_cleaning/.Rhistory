knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("./data/vaccination_covid_19_Laos.csv")
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
library(tidyverse)
library(httr)
library(openxlsx)
library(readxl)
library(lubridate)
library(jsonlite)
# dir_indicator_ID <- '/Users/douangtavanh/Documents/WHO/Data/COVID_ID/Indicator_ID_COVID_Agg.xlsx'
# indicator_ID <- read_xlsx(dir_indicator_ID)
# indicator_list <- str_flatten(indicator_ID$id, ";")
indicator_list <- c(
"JMiLwobkeNE", #CVR Agg - Total number of people received at least 1 dose
"mqq7TJKv4bP", #CVR Agg - Total number of people received all recommended doses
"vh9CTo4hL35", #CVR Agg - Total number of people received booster dose 1
"kIEf7qgOCG2" #CVR Agg - Total number of people received booster dose 2
)
org_unit <- 'RdNV4tTRNEo' #Xayyabouly
cleanDate <- \(dateInput) {
return (str_remove_all(toString(as_date(dateInput)), "-"))
}
generate_date_in_2021 <- \() {
startDate21 <- as_date('20210101')
# lastDate21 <- as_date('20220531')
lastDate21 <- as_date(today())
day_in_2021 <- ""
for (i in startDate21:lastDate21) {
if (i < as_date(lastDate21)) {
var <- paste0(cleanDate(i), ";")
} else {
var <- cleanDate(i)
}
day_in_2021 <- paste0(day_in_2021, var)
}
return (day_in_2021)
}
date_21 <- generate_date_in_2021()
cat_indicator <- str_flatten(indicator_list, collapse = ";")
base.url <- "https://covid.gov.la/dhis/"
url <- paste0(base.url, "api/me")
username <- "douangtavanh@kongphaly.la"
password <- "ena*KNF8czb8cam@nan"
login <- GET(url, authenticate(username, password))
#If we cannot login, stop with an error
if (login$status == 200L) { print("Logged in successfully!") } else { stop("Could not login") }
url_get_data <- paste0(base.url,
"api/33/analytics.csv?",
"dimension=dx:", cat_indicator,
"&dimension=ou:LEVEL-4;", org_unit,
"&dimension=pe:", date_21,
"&displayProperty=NAME",
"&showHierarchy=true",
"&outputIdScheme=NAME",
"&tableLayout=true&columns=dx&rows=ou;pe"
)
df<-paste0(url_get_data) |> #Define the API endpoint
GET(authenticate(username,password)) |> #Make the HTTP call
content("text") |> #Read the response
read_csv() #Parse the CSV
# filter(is.na(`CVR Agg - Total number of people received at least 1 dose`) == F |
#                is.na(`CVR Agg - Total number of people received all recommended doses`) == F |
# is.na(`CVR Agg - Total number of people received booster dose 1`) == F |
# is.na(`CVR Agg - Total number of people received booster dose 2` == F))
#replace NA with 0
df <- df |> replace_na(list(`CVR Agg - Total number of people received at least 1 dose` = 0,
`CVR Agg - Total number of people received all recommended doses` = 0,
`CVR Agg - Total number of people received booster dose 1` = 0,
`CVR Agg - Total number of people received booster dose 2` = 0))
write_csv(df, '/Users/douangtavanh/Desktop/Daily tracking/Xayyabouly/output_XBL_LV4.csv')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
diffData <- tibble(total_vaccinated = diff(fullDateDf$total_vaccinated),
people_vaccinated = diff(fullDateDf$people_vaccinated),
people_fully_vaccinated = diff(fullDateDf$people_fully_vaccinated))
diffData <- mutate(diffData, maTotal = rollmean(diffData$total_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_vaccinated = rollmean(diffData$people_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, maPeople_fully_vaccinated = rollmean(diffData$people_fully_vaccinated, 7, fill = NA))
diffData <- mutate(diffData, date=fullDateDf$date[2:nrow(fullDateDf)])
ggplot(data = diffData) +
geom_col(mapping = aes(x = date, y = total_vaccinated, color="")) +
geom_line(mapping= aes(x = date, y = maTotal, color="average (7 days)")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
ggplot(data = diffData) +
geom_line(mapping= aes(x = date, y = maPeople_vaccinated, color="vaccinated")) +
geom_line(mapping= aes(x = date, y = maPeople_fully_vaccinated, color="fully vaccinated")) +
scale_x_datetime(date_labels = "%d/%m", date_breaks = "3 weeks") +
scale_color_brewer(palette = "Pastel1")
# Export data
write.csv(fullDateDf, "../data/vaccination_covid_19_Laos_adjusted.csv")
write.csv(diffData, "../data/vaccination_covid_19_Laos_adjusted_diff.csv")
