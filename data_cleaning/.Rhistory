knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(zoo)
df <- read_csv("./data/vaccination_covid_19_Laos.csv")
df <- read_csv("../data/vaccination_covid_19_Laos.csv")
df$date <- strptime(df$date, "%d/%m/%Y")
dateGerneate <- seq(as.Date(df$date[1]), Sys.Date(), by="day")
newDate <- tibble(dateGerneate) #create dataframe
colnames(newDate)[1] <- "date" #rename col
fullDateDf <- df %>%
full_join(newDate, by="date")
fullDateDf <- fullDateDf %>%
arrange(date)
fullDateDf <- fullDateDf %>%
fill(total_vaccinated, .direction="down") %>%
fill(people_vaccinated, .direction="down") %>%
fill(people_fully_vaccinated, .direction="down") %>%
replace_na(list(source_url = "NA"))
fullDateDf <- mutate(fullDateDf, movingAverage = rollmean(fullDateDf$total_vaccinated, 7, fill = NA))
ggplot(data = fullDateDf) +
geom_col(mapping = aes(x = date, y = total_vaccinated)) +
geom_line(mapping= aes(x = date, y = movingAverage, color="red"))
